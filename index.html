<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <base target="_top">
    <title>Fitxatge</title>
    <script>
      async function redirigirAmbIP() {
        try {
          const resposta = await fetch("https://api.ipify.org?format=json");
          const dades = await resposta.json();
          const ip = dades.ip;

          const params = new URLSearchParams(window.location.search);
          params.append("ip", ip);

          // Posa aquí la teva URL d’Apps Script!
          const novaURL = "https://script.google.com/macros/s/AKfycbzm3O_Usz6DtHZHJAJP_hOoOsC0tdhKHrzrqmkqyNut52-AyBdlb0vtL8t_8NHlaQf6Iw/exec?" + params.toString();

          window.location.href = novaURL;
        } catch (error) {
          document.body.innerHTML = "Error capturant la IP. Torna-ho a intentar.";
        }
      }

      window.onload = redirigirAmbIP;
    </script>
  </head>
  <body>
    <p>Capturant IP... ⏳</p>
  </body>
</html>
